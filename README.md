# SumYourDay - Ваш Ассистент для Голосовых Сообщений в Telegram

**SumYourDay** — это Telegram-бот, созданный для эффективной обработки ваших голосовых сообщений. Он автоматически транскрибирует аудиозаписи, создает краткие резюме с помощью больших языковых моделей (LLM) и сохраняет всю информацию для удобного доступа.

## Возможности

*   **Транскрибация Голосовых Сообщений:** Преобразует входящие голосовые сообщения в текст, используя офлайн-модель распознавания речи Vosk.
*   **Резюмирование с Помощью ИИ:** Генерирует лаконичные резюме транскрибированных текстов с использованием LLM.
    *   Поддерживает локально запущенные LLM через Ollama (например, Mistral, Llama, Gemma).
    *   Поддерживает облачные LLM через OpenAI API (например, GPT-3.5-turbo, GPT-4o).
*   **Хранение Данных:** Сохраняет как полную транскрипцию, так и сгенерированное резюме в локальную базу данных SQLite.
*   **Ежедневные Сводки:** Позволяет получить список всех резюме за определенный день (или текущий день) с помощью команды `/sum`.
*   **Гибкая Настройка:** Легко переключайтесь между LLM-провайдерами и моделями через конфигурационный файл `.env`.

## Предварительные Требования

Перед началом установки убедитесь, что у вас установлены:

*   **Python 3.x** (рекомендуется 3.8+)
*   **pip** (менеджер пакетов Python)
*   **Git** (для клонирования репозитория)
*   **(Опционально) Ollama:** Если вы планируете использовать локальные LLM. Загрузите и установите с [ollama.com](https://ollama.com/).
*   **(Потенциально) FFmpeg:** Хотя бот использует `soundfile` и `resampy` для конвертации аудио, `soundfile` (через библиотеку `libsndfile`) может требовать наличия FFmpeg для поддержки формата OGG/Opus, если `libsndfile` не была скомпилирована с их нативной поддержкой. Если возникнут проблемы с обработкой OGG, установка FFmpeg и добавление его в системный `PATH` может помочь.

## Инструкция по Установке

1.  **Клонируйте Репозиторий:**
    ```bash
    git clone https://github.com/ВАШ_ЛОГИН/НАЗВАНИЕ_ВАШЕГО_РЕПОЗИТОРИЯ.git
    cd НАЗВАНИЕ_ВАШЕГО_РЕПОЗИТОРИЯ
    ```
    *(Замените `ВАШ_ЛОГИН/НАЗВАНИЕ_ВАШЕГО_РЕПОЗИТОРИЯ` на ваш логин и название репозитория на GitHub)*

2.  **Создайте и Активируйте Виртуальное Окружение (Рекомендуется):**
    ```bash
    python -m venv .venv
    # Для Windows
    # .venv\Scripts\activate
    # Для macOS/Linux
    source .venv/bin/activate
    ```

3.  **Установите Зависимости Python:**
    В идеале, в репозитории должен быть файл `requirements.txt`. Если он есть, выполните:
    ```bash
    pip install -r requirements.txt
    ```
    Если файла `requirements.txt` нет, установите пакеты вручную:
    ```bash
    pip install python-telegram-bot python-dotenv requests vosk soundfile resampy openai
    ```
    *(Пакет `openai` необходим только если вы планируете использовать LLM от OpenAI).*

4.  **Загрузите и Настройте Модель Vosk:**
    *   Загрузите модель Vosk для русского языка (например, `vosk-model-small-ru-0.22`) с [официального репозитория моделей Vosk](https://alphacephei.com/vosk/models).
    *   Распакуйте архив в директорию внутри вашего проекта, например, `models/vosk-model-small-ru-0.22`.
    *   Путь к этой директории нужно будет указать в файле `.env`.

5.  **Настройте Ollama (Если Используются Локальные LLM):**
    *   Убедитесь, что Ollama установлена и запущена.
    *   Загрузите желаемые модели, например:
        ```bash
        ollama pull mistral
        ollama pull gemma:2b # или любая другая модель
        ```

6.  **Создайте и Настройте Файл `.env`:**
    *   В корневой директории проекта создайте файл с именем `.env`.
    *   Скопируйте содержимое из `example.env` (если он предоставлен в репозитории) или добавьте следующие переменные, указав ваши реальные значения:

    ```dotenv
    # --- Telegram ---
    TG_BOT_TOKEN="ВАШ_ТЕЛЕГРАМ_БОТ_ТОКЕН"

    # --- База данных ---
    DB_PATH="bot.db"

    # --- Настройки LLM ---
    # Установите "True" для использования локальной Ollama, "False" для облачной LLM (например, OpenAI)
    USE_LOCAL_LLM="True"

    # Настройки Ollama (если USE_LOCAL_LLM="True")
    OLLAMA_BASE_URL="http://127.0.0.1:11434"
    OLLAMA_MODEL="mistral" # Или другая модель, загруженная в Ollama

    # Настройки OpenAI (если USE_LOCAL_LLM="False")
    OPENAI_API_KEY="sk-ВАШ_OPENAI_API_КЛЮЧ"
    OPENAI_MODEL="gpt-3.5-turbo"

    # --- Распознавание речи ---
    VOSK_MODEL_PATH="models/vosk-model-small-ru-0.22" # Обновите путь, если он другой

    # --- Логирование ---
    LOG_FILE="bot.log"

    # --- Параметры Суммаризации ---
    SUMMARY_MAX_TRIES="2"
    SUMMARY_DEVIATION_PERCENT="20"
    ```
    **Важно:**
    *   Замените `"ВАШ_ТЕЛЕГРАМ_БОТ_ТОКЕН"` на токен, полученный от BotFather в Telegram.
    *   Если используете OpenAI, замените `"sk-ВАШ_OPENAI_API_КЛЮЧ"`.
    *   Убедитесь, что `VOSK_MODEL_PATH` указывает на правильную директорию с распакованной моделью Vosk.

## Запуск Бота

После установки всех зависимостей и настройки файла `.env`, вы можете запустить бота:

```bash
python telegram_voice_daily_sum_bot.py
